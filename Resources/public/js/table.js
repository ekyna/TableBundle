!function(a,b){"use strict";"undefined"!=typeof module&&module.exports?module.exports=b(require("jquery")):"function"==typeof define&&define.amd?define("ekyna-table",["jquery"],function(a){return b(a)}):a.EkynaTable=b(a.jQuery)}(this,function(a){"use strict";var b=function(b,c){this.$elem="jQuery"==typeof b?b:a(b),this.options=c||[],this.metadata=this.$elem.data("options")};return b.prototype={defaults:{onSelection:function(a){},ajax:!1},init:function(){this.config=a.extend({},this.defaults,this.options,this.metadata),this.config.ajax&&this.$elem.find("a").bind("click",function(a){a.preventDefault(),a.stopPropagation(),alert("Not yet implemented.")}),this.config.selector&&this.initSelector(),this.initTreeNodes();var b=this;return this.$elem.on("click",".table-select-toggle",function(c){b.$elem.find("tbody .selector input").prop("checked",a(this).prop("checked"))}),this.$elem.on("click",".table-filter-close",function(b){return a(this).parents(".table-filters-form").remove(),b.stopPropagation(),b.preventDefault(),!1}),this.$elem.on("click",".table-config .dropdown-menu",function(a){a.stopPropagation()}),this},initSelector:function(){var b=this;b.$elem.find("button.table-selection-validate").bind("click",function(c){if(c.preventDefault(),c.stopPropagation(),void 0!==b.config.onSelection){var d=[];b.$elem.find("td.selector input:checked").each(function(){d.push(a(this).data("element"))}),b.config.onSelection(d)}})},initTreeNodes:function(){function b(a,b){a.hasClass("toggle-open")?c(a,b):a.hasClass("toggle-close")&&d(a)}function c(b,d){b.hasClass("toggle-open")&&(a(b.data("children")).each(function(b,f){var g=e.$elem.find("tr[data-id="+f+"]").show();d&&g.find("a.toggle").each(function(b,e){c(a(e),d)})}),b.removeClass("toggle-open").addClass("toggle-close"))}function d(b){b.hasClass("toggle-close")&&(a(b.data("children")).each(function(b,c){var f=e.$elem.find("tr[data-id="+c+"]").hide();f.find("a.toggle").each(function(b,c){d(a(c))})}),b.removeClass("toggle-close").addClass("toggle-open"))}var e=this;e.$elem.find("td.nested a.toggle").bind("click",function(c){c.preventDefault(),c.stopPropagation(),b(a(c.target),c.shiftKey)}),e.$elem.find("td.nested > a.toggle-close").each(function(b,c){d(a(c))})}},b.defaults=b.prototype.defaults,{create:function(a,c){var d=new b(a,c);return d.init(),d}}});