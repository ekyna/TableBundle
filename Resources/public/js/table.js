!function(e,t){"use strict";"undefined"!=typeof module&&module.exports?module.exports=t(require("jquery")):"function"==typeof define&&define.amd?define("ekyna-table",["jquery"],t):e.EkynaTable=t(e.jQuery)}(this,function(a){"use strict";function n(e,t){this.$elem="jQuery"==typeof e?e:a(e),this.options=t||[],this.metadata=this.$elem.data("options")}return n.defaults=(n.prototype={defaults:{onSelection:function(e){},ajax:!1},init:function(){this.config=a.extend({},this.defaults,this.options,this.metadata),this.config.ajax&&this.$elem.find("a").bind("click",function(e){e.preventDefault(),e.stopPropagation(),alert("Not yet implemented.")}),this.config.selector&&this.initSelector(),this.initTreeNodes();var t=this;return this.$elem.on("click",".table-select-toggle",function(e){t.$elem.find("tbody .selector input").prop("checked",a(this).prop("checked"))}),this.$elem.on("click",".table-filter-close",function(e){return a(this).parents(".table-filters-form").remove(),e.stopPropagation(),e.preventDefault(),!1}),this.$elem.on("click",".table-config .dropdown-menu",function(e){e.stopPropagation()}),this},initSelector:function(){var n=this;n.$elem.find("button.table-selection-validate").bind("click",function(e){var t;e.preventDefault(),e.stopPropagation(),void 0!==n.config.onSelection&&(t=[],n.$elem.find("td.selector input:checked").each(function(){t.push(a(this).data("element"))}),n.config.onSelection(t))})},initTreeNodes:function(){var o=this;function t(e,t){e.hasClass("toggle-open")?function n(e,i){if(!e.hasClass("toggle-open"))return;a(e.data("children")).each(function(e,t){t=o.$elem.find("tr[data-id="+t+"]").show();i&&t.find("a.toggle").each(function(e,t){n(a(t),i)})});e.removeClass("toggle-open").addClass("toggle-close")}(e,t):e.hasClass("toggle-close")&&n(e)}function n(e){e.hasClass("toggle-close")&&(a(e.data("children")).each(function(e,t){o.$elem.find("tr[data-id="+t+"]").hide().find("a.toggle").each(function(e,t){n(a(t))})}),e.removeClass("toggle-close").addClass("toggle-open"))}o.$elem.find("td.nested a.toggle").bind("click",function(e){e.preventDefault(),e.stopPropagation(),t(a(e.target),e.shiftKey)}),o.$elem.find("td.nested > a.toggle-close").each(function(e,t){n(a(t))})}}).defaults,{create:function(e,t){e=new n(e,t);return e.init(),e}}});